<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refinance Comparison Tool</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: flex-start;
        }

        .form-container {
            width: 400px;
            padding: 20px;
        }

        .form-section {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
        }

        .subject-property {
            background-color: #f0f8ff;
        }

        .existing-mortgage {
            background-color: #e6ffe6;
        }

        .proposed-refinance {
            background-color: #ffe6e6;
        }

        .form-group {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        label {
            flex: 1;
            margin-right: 10px;
        }

        input, select {
            flex: 1;
            padding: 5px;
            font-size: 1em;
            width: 100px;
            text-align: right;
        }

        .comparison-results {
            margin-left: 20px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            width: 500px;
        }

        h3 {
            margin-bottom: 10px;
        }

        .graph-container {
            margin-top: 20px;
            width: 100%;
            height: 300px;
        }
    </style>
</head>
<body>

    <div class="form-container">
        <h1>Refinance Comparison Tool</h1>
        
        <!-- Subject Property Section -->
        <div class="form-section subject-property">
            <h3>Subject Property</h3>
            <div class="form-group">
                <label for="borrowerName">Borrower Name:</label>
                <input type="text" id="borrowerName">
            </div>
            <div class="form-group">
                <label for="propertyID">Property ID:</label>
                <input type="text" id="propertyID">
            </div>
            <div class="form-group">
                <label for="currentValue">Current Value:</label>
                <input type="text" id="currentValue" oninput="formatCurrency(this)">
            </div>
            <div class="form-group">
                <label for="propertyTaxes">Current Property Taxes (Annual):</label>
                <input type="text" id="propertyTaxes" oninput="formatCurrency(this)">
            </div>
            <div class="form-group">
                <label for="homeownersInsurance">Current Homeowner's Insurance Premium (Annual):</label>
                <input type="text" id="homeownersInsurance" oninput="formatCurrency(this)">
            </div>
        </div>

        <!-- Existing Mortgage Section -->
        <div class="form-section existing-mortgage">
            <h3>Existing Mortgage</h3>
            <div class="form-group">
                <label for="purchaseDate">Date of Purchase:</label>
                <input type="date" id="purchaseDate">
            </div>
            <div class="form-group">
                <label for="purchasePrice">Purchase Price:</label>
                <input type="text" id="purchasePrice" oninput="formatCurrency(this)">
            </div>
            <div class="form-group">
                <label for="downPaymentPercent">Down Payment %:</label>
                <input type="text" id="downPaymentPercent" oninput="calculateDownPaymentPercent()">
            </div>
            <div class="form-group">
                <label for="downPaymentAmount">Down Payment $:</label>
                <input type="text" id="downPaymentAmount" oninput="calculateDownPaymentAmount()">
            </div>
            <div class="form-group">
                <label for="originalLoanAmount">Original Base Loan Amount:</label>
                <input type="text" id="originalLoanAmount" readonly>
            </div>
            <div class="form-group">
                <label for="interestRate">Original Interest Rate:</label>
                <input type="text" id="interestRate" oninput="formatPercentage(this)">
            </div>
            <div class="form-group">
                <label for="fhaLoan">FHA Loan:</label>
                <select id="fhaLoan" onchange="checkFhaLoan()">
                    <option value="no">NO</option>
                    <option value="yes">YES</option>
                </select>
            </div>
            <div class="form-group">
                <label for="mortgageInsuranceFactor">Mortgage Insurance Factor:</label>
                <input type="text" id="mortgageInsuranceFactor" readonly>
            </div>
        </div>

        <!-- Proposed Refinance Section -->
        <div class="form-section proposed-refinance">
            <h3>Proposed Refinance</h3>
            <div class="form-group">
                <label for="newLoanAmount">New Base Loan Amount:</label>
                <input type="text" id="newLoanAmount" readonly>
            </div>
            <div class="form-group">
                <label for="newInterestRate">New Interest Rate:</label>
                <input type="text" id="newInterestRate" oninput="formatPercentage(this)">
            </div>
            <div class="form-group">
                <label for="discountPointsPercent">Discount Points %:</label>
                <input type="text" id="discountPointsPercent" oninput="calculateDiscountPointsPercent()">
            </div>
            <div class="form-group">
                <label for="discountPointsAmount">Discount Points $:</label>
                <input type="text" id="discountPointsAmount" oninput="calculateDiscountPointsAmount()">
            </div>
            <h4>Escrow Costs</h4>
            <div class="form-group">
                <label for="settlementFee">Settlement Fee:</label>
                <input type="text" id="settlementFee" oninput="formatCurrency(this)">
            </div>
            <div class="form-group">
                <label for="title">Title:</label>
                <input type="text" id="title" oninput="formatCurrency(this)">
            </div>
            <div class="form-group">
                <label for="recording">Recording:</label>
                <input type="text" id="recording" oninput="formatCurrency(this)">
            </div>
            <h4>Prepaids</h4>
            <div class="form-group">
                <label for="prepaidTaxes">Prepaid Property Taxes:</label>
                <input type="text" id="prepaidTaxes" oninput="formatCurrency(this)">
            </div>
            <div class="form-group">
                <label for="prepaidInsurance">Prepaid Homeowner's Insurance:</label>
                <input type="text" id="prepaidInsurance" oninput="formatCurrency(this)">
            </div>
            <h4>Loan Costs</h4>
            <div class="form-group">
                <label for="processingFee">Processing & Underwriting:</label>
                <input type="text" id="processingFee" value="$1,500" oninput="formatCurrency(this)">
            </div>
            <div class="form-group">
                <label for="appraisal">Appraisal:</label>
                <input type="text" id="appraisal" value="$900" oninput="formatCurrency(this)">
            </div>
            <div class="form-group">
                <label for="misc">Misc:</label>
                <input type="text" id="misc" value="$250" oninput="formatCurrency(this)">
            </div>
            <div class="form-group">
                <label for="fhaLoanProposed">FHA Loan:</label>
                <select id="fhaLoanProposed" onchange="checkFhaLoanProposed()">
                    <option value="no">NO</option>
                    <option value="yes">YES</option>
                </select>
            </div>
            <div class="form-group">
                <label for="mortgageInsuranceFactorProposed">Mortgage Insurance Factor:</label>
                <input type="text" id="mortgageInsuranceFactorProposed" readonly>
            </div>
            <div class="form-group">
                <label for="totalProposedLoanAmount">Total Proposed Loan Amount:</label>
                <input type="text" id="totalProposedLoanAmount" readonly>
            </div>
        </div>
    </div>

    <div class="comparison-results">
        <h3>Loan Comparison Results</h3>
        <p>Existing Loan Monthly Payment: $0.00</p>
        <p>Proposed Refinance Monthly Payment: $0.00</p>
        <p>Monthly Savings: $0.00</p>
        <p>Break-even Point: 0 months</p>
        <p>Total Interest Paid: $0.00</p>

        <div class="graph-container">
            <canvas id="comparisonGraph"></canvas>
        </div>
    </div>

    <script>
        function formatCurrency(input) {
            let value = parseFloat(input.value.replace(/[^0-9.-]+/g,""));
            if (isNaN(value)) value = 0;
            input.value = "$" + value.toFixed(2);
        }

        function formatPercentage(input) {
            let value = parseFloat(input.value.replace(/[^0-9.-]+/g,""));
            if (isNaN(value)) value = 0;
            input.value = value.toFixed(2) + "%";
        }

        function calculateDiscountPointsPercent() {
            let loanAmount = parseFloat(document.getElementById('newLoanAmount').value.replace(/[^0-9.-]+/g,""));
            let discountPointsAmount = parseFloat(document.getElementById('discountPointsAmount').value.replace(/[^0-9.-]+/g,""));
            if (loanAmount && discountPointsAmount) {
                let percent = (discountPointsAmount / loanAmount) * 100;
                document.getElementById('discountPointsPercent').value = percent.toFixed(2) + "%";
            }
        }

        function calculateDiscountPointsAmount() {
            let loanAmount = parseFloat(document.getElementById('newLoanAmount').value.replace(/[^0-9.-]+/g,""));
            let discountPointsPercent = parseFloat(document.getElementById('discountPointsPercent').value.replace(/[^0-9.-]+/g,""));
            if (loanAmount && discountPointsPercent) {
                let amount = (discountPointsPercent / 100) * loanAmount;
                document.getElementById('discountPointsAmount').value = "$" + amount.toFixed(2);
            }
        }

        function checkFhaLoanProposed() {
            let fhaLoan = document.getElementById('fhaLoanProposed').value;
            if (fhaLoan === "yes") {
                document.getElementById('mortgageInsuranceFactorProposed').value = "0.55%";
            } else {
                document.getElementById('mortgageInsuranceFactorProposed').value = "";
            }
        }
    </script>

</body>
</html>
